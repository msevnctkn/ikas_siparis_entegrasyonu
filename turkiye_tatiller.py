from datetime import datetime, timedelta


class RESMI_TATILLER():
    def __init__(self):

        self.tatil_gunleri = set([
            "01.01.2025", "23.04.2025", "01.05.2025", "19.05.2025",
            "15.07.2025", "30.08.2025", "29.10.2025",
            "31.03.2025", "01.04.2025",  # Ramazan
            "06.06.2025", "07.06.2025", "08.06.2025", "09.06.2025",  # Kurban

            "01.01.2026", "23.04.2026", "01.05.2026", "19.05.2026",
            "15.07.2026", "30.08.2026", "29.10.2026",
            "20.03.2026", "21.03.2026", "22.03.2026", "23.03.2026",  # Ramazan
            "26.05.2026", "27.05.2026", "28.05.2026", "29.05.2026",  # Kurban

            "01.01.2027", "23.04.2027", "01.05.2027", "19.05.2027",
            "15.07.2027", "30.08.2027", "29.10.2027",
            "10.03.2027", "11.03.2027", "12.03.2027", "13.03.2027",
            "16.05.2027", "17.05.2027", "18.05.2027", "19.05.2027",

            "01.01.2028", "23.04.2028", "01.05.2028", "19.05.2028",
            "15.07.2028", "30.08.2028", "29.10.2028",
            "26.02.2028", "27.02.2028", "28.02.2028", "29.02.2028",
            "04.05.2028", "05.05.2028", "06.05.2028", "07.05.2028",

            "01.01.2029", "23.04.2029", "01.05.2029", "19.05.2029",
            "15.07.2029", "30.08.2029", "29.10.2029",
            "14.02.2029", "15.02.2029", "16.02.2029", "17.02.2029",
            "24.04.2029", "25.04.2029", "26.04.2029", "27.04.2029",

            "01.01.2030", "23.04.2030", "01.05.2030", "19.05.2030",
            "15.07.2030", "30.08.2030", "29.10.2030",
            "03.02.2030", "04.02.2030", "05.02.2030", "06.02.2030",
            "13.04.2030", "14.04.2030", "15.04.2030", "16.04.2030",
        ])

    # string → datetime çevrimi
        self.tatil_gunleri_format = {datetime.strptime(d, "%d.%m.%Y").date() for d in self.tatil_gunleri}


    def is_gunu_ekle(self, tarih_str, is_gunu):
        """
        tarih_str: "29.12.2025"
        is_gunu: eklenecek iş günü sayısı
        """

        tarih = datetime.strptime(tarih_str, "%d.%m.%Y").date()
        kalan = is_gunu

        while kalan > 0:
            tarih += timedelta(days=1)

            # Cumartesi (5) ve Pazar (6) geç
            if tarih.weekday() >= 5:
                continue

            # Resmi tatilse geç
            if tarih in self.tatil_gunleri_format:
                continue

            kalan -= 1

        return tarih.strftime("%d.%m.%Y")